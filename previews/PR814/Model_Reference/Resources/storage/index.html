<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Storage · GenX.jl</title><meta name="title" content="Storage · GenX.jl"/><meta property="og:title" content="Storage · GenX.jl"/><meta property="twitter:title" content="Storage · GenX.jl"/><meta name="description" content="Documentation for GenX.jl."/><meta property="og:description" content="Documentation for GenX.jl."/><meta property="twitter:description" content="Documentation for GenX.jl."/><meta property="og:url" content="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Resources/storage/"/><meta property="twitter:url" content="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Resources/storage/"/><link rel="canonical" href="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Resources/storage/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/genx_style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="GenX.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="GenX.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome Page</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">GenX: Introduction</a></li><li><a class="tocitem" href="../../../installation/">Installation Guide</a></li><li><a class="tocitem" href="../../../limitations_genx/">Limitation of GenX</a></li><li><a class="tocitem" href="../../../third_party_genx/">Third Party Extensions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Getting_Started/examples_casestudies/">Running GenX</a></li><li><a class="tocitem" href="../../../Getting_Started/commercial_solvers/">Commertial solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Tutorials/Tutorials_intro/">Tutorials Overview</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_1_configuring_settings/">Tutorial 1: Configuring Settings</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_2_network_visualization/">Tutorial 2: Network Visualization</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_3_K-means_time_domain_reduction/">Tutorial 3: K-Means and Time Domain Reduction</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_4_model_generation/">Tutorial 4: Model Generation</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_5_solve_model/">Tutorial 5: Solving the Model</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_6_solver_settings/">Tutorial 6: Solver Settings</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_7_setup/">Tutorial 7: Policy Constraints</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_8_outputs/">Tutorial 8: Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../User_Guide/workflow/">Overall workflow</a></li><li><a class="tocitem" href="../../../User_Guide/model_configuration/">Model Configuration</a></li><li><a class="tocitem" href="../../../User_Guide/solver_configuration/">Solver Configuration</a></li><li><a class="tocitem" href="../../../User_Guide/model_input/">Model Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/TDR_input/">Time-domain Reduction Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/running_TDR/">Running the Time-domain Reduction</a></li><li><a class="tocitem" href="../../../User_Guide/generate_alternatives/">MGA package</a></li><li><a class="tocitem" href="../../../User_Guide/multi_stage_input/">Multi-stage Model</a></li><li><a class="tocitem" href="../../../User_Guide/slack_variables_overview/">Slack Variables for Policies</a></li><li><a class="tocitem" href="../../../User_Guide/methodofmorris_input/">Method of Morris Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/running_model/">Running the Model</a></li><li><a class="tocitem" href="../../../User_Guide/model_output/">Model Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Model Concept and Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Model_Concept_Overview/model_introduction/">Model Introduction</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/model_notation/">Notation</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/objective_function/">Objective Function</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/power_balance/">Power Balance</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Model Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../core/">Core</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../curtailable_variable_renewable/">Curtailable Variable Renewable</a></li><li><a class="tocitem" href="../flexible_demand/">Flexible Demand</a></li><li><input class="collapse-toggle" id="menuitem-6-2-3" type="checkbox"/><label class="tocitem" for="menuitem-6-2-3"><span class="docs-label">Hydro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../hydro_res/">Hydro Reservoir</a></li><li><a class="tocitem" href="../hydro_inter_period_linkage/">Long Duration Hydro</a></li></ul></li><li><a class="tocitem" href="../must_run/">Must Run</a></li><li><a class="tocitem" href="../retrofit/">Retrofit</a></li><li><input class="collapse-toggle" id="menuitem-6-2-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6-2-6"><span class="docs-label">Storage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Storage</a></li><li><a class="tocitem" href="../investment_charge/">Investment Charge</a></li><li><a class="tocitem" href="../investment_energy/">Investment Energy</a></li><li><a class="tocitem" href="../long_duration_storage/">Long Duration Storage</a></li><li><a class="tocitem" href="../storage_all/">Storage All</a></li><li><a class="tocitem" href="../storage_asymmetric/">Storage Asymmetric</a></li><li><a class="tocitem" href="../storage_symmetric/">Storage Symmetric</a></li></ul></li><li><a class="tocitem" href="../vre_stor/">Co-located VRE and Storage</a></li><li><input class="collapse-toggle" id="menuitem-6-2-8" type="checkbox"/><label class="tocitem" for="menuitem-6-2-8"><span class="docs-label">Thermal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../thermal/">Thermal</a></li><li><a class="tocitem" href="../thermal_commit/">Thermal Commit</a></li><li><a class="tocitem" href="../thermal_no_commit/">Thermal No Commit</a></li><li><a class="tocitem" href="../maintenance/">Scheduled maintenance for Thermal Commit</a></li><li><a class="tocitem" href="../fusion/">Fusion</a></li></ul></li><li><a class="tocitem" href="../electrolyzers/">Hydrogen Electrolyzers</a></li><li><a class="tocitem" href="../resource/">Resource types</a></li></ul></li><li><a class="tocitem" href="../../policies/">Policies</a></li><li><a class="tocitem" href="../../solver_configuration_api/">Solver Configurations</a></li><li><a class="tocitem" href="../../load_inputs/">Inputs Functions</a></li><li><a class="tocitem" href="../../generate_model/">Generate the Model</a></li><li><a class="tocitem" href="../../solve_model/">Solving the Model</a></li><li><a class="tocitem" href="../../TDR/">Time-domain Reduction</a></li><li><a class="tocitem" href="../../write_outputs/">Outputs Functions</a></li><li><a class="tocitem" href="../../mga/">Modeling to Generate Alternatives</a></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Multi-stage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Multi_Stage/multi_stage_overview/">Multi-Stage Modeling Introduction</a></li><li><a class="tocitem" href="../../Multi_Stage/configure_multi_stage_inputs/">Configure multi-stage inputs</a></li><li><a class="tocitem" href="../../Multi_Stage/dual_dynamic_programming/">Model multi stage: Dual Dynamic Programming Algorithm</a></li><li><a class="tocitem" href="../../Multi_Stage/endogenous_retirement/">Endogenous Retirement</a></li></ul></li><li><a class="tocitem" href="../../methodofmorris/">Method of Morris</a></li><li><a class="tocitem" href="../../utility_functions/">Utility Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Public API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Public_API/public_api/">Public API</a></li></ul></li><li><a class="tocitem" href="../../../additional_third_party_extensions/">Third Party Extensions</a></li><li><a class="tocitem" href="../../../developer_guide/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Reference</a></li><li><a class="is-disabled">Resources</a></li><li><a class="is-disabled">Storage</a></li><li class="is-active"><a href>Storage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Storage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl/blob/main/docs/src/Model_Reference/Resources/storage.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Storage"><a class="docs-heading-anchor" href="#Storage">Storage</a><a id="Storage-1"></a><a class="docs-heading-anchor-permalink" href="#Storage" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GenX.storage!" href="#GenX.storage!"><code>GenX.storage!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">storage!(EP::Model, inputs::Dict, setup::Dict)</code></pre><p>A wide range of energy storage devices (all <span>$o \in \mathcal{O}$</span>) can be modeled in GenX, using one of two generic storage formulations: (1) storage technologies with symmetric charge and discharge capacity (all <span>$o \in \mathcal{O}^{sym}$</span>), such as Lithium-ion batteries and most other electrochemical storage devices that use the same components for both charge and discharge; and (2) storage technologies that employ distinct and potentially asymmetric charge and discharge capacities (all <span>$o \in \mathcal{O}^{asym}$</span>), such as most thermal storage technologies or hydrogen electrolysis/storage/fuel cell or combustion turbine systems.</p><p>If a capacity reserve margin is modeled, variables for virtual charge, <span>$\Pi^{CRM}_{o,z,t}$</span>, and virtual discharge, <span>$\Theta^{CRM}_{o,z,t}$</span>, are created to represent  	contributions that a storage device makes to the capacity reserve margin without actually generating power. (This functionality can be turned off with the parameter StorageVirtualDischarge in the GenX settings file.) These represent power that the storage device could  	have discharged or consumed if called upon to do so, based on its available state of charge. Importantly, a dedicated set of variables (those of the form <span>$\Pi^{CRM}_{o,z,t}, \Theta^{CRM}_{o,z,t}$</span>)  	and constraints are created to ensure that any virtual contributions to the capacity reserve margin could be made as actual charge/discharge if necessary without  	affecting system operations in any other timesteps. If a capacity reserve margin is not modeled, all related variables are fixed at 0. The overall contribution  	of storage devices to the system&#39;s capacity reserve margin in timestep <span>$t$</span> is equal to <span>$\sum_{y \in \mathcal{O}} \epsilon_{y,z,p}^{CRM} \times \left(\Theta_{y,z,t} + \Theta^{CRM}_{o,z,t} - \Pi^{CRM}_{o,z,t} - \Pi_{y,z,t} \right)$</span>,  	and includes both actual and virtual charge and discharge.</p><p class="math-container">\[\begin{aligned}
	&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p><strong>Storage with symmetric charge and discharge capacity</strong> For storage technologies with symmetric charge and discharge capacity (all <span>$o \in \mathcal{O}^{sym}$</span>), charge rate, <span>$\Pi_{o,z,t}$</span>, and virtual charge rate, <span>$\Pi^{CRM}_{o,z,t}$</span>, are jointly constrained by the total installed power capacity, <span>$\Omega_{o,z}$</span>. Since storage resources generally represent a `cluster&#39; of multiple similar storage devices of the same type/cost in the same zone, GenX permits storage resources to simultaneously charge and discharge (as some units could be charging while others discharge), with the simultaenous sum of charge, <span>$\Pi_{o,z,t}$</span>, discharge, <span>$\Theta_{o,z,t}$</span>, virtual charge, <span>$\Pi^{CRM}_{o,z,t}$</span>, and virtual discharge, <span>$\Theta^{CRM}_{o,z,t}$</span>, also limited by the total installed power capacity, <span>$\Delta^{total}_{o,z}$</span>. These two constraints are as follows:</p><p class="math-container">\[\begin{aligned}
&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T}\\
&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>These constraints are created with the function <code>storage_symmetric!()</code> in <code>storage_symmetric.jl</code>. If reserves are modeled, the following two constraints replace those above:</p><p class="math-container">\[\begin{aligned}
&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + f^{charge}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T}\\
&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + f^{charge}_{o,z,t} + \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} + f^{discharge}_{o,z,t} + r^{discharge}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{sym}, z \in \mathcal{Z}, t \in \mathcal{T} \\
\end{aligned}\]</p><p>where <span>$f^{charge}_{o,z,t}$</span> is the contribution of storage resources to frequency regulation while charging, <span>$f^{discharge}_{o,z,t}$</span> is the contribution of storage resources to frequency regulation while discharging, and <span>$r^{discharge}_{o,z,t}$</span> is the contribution of storage resources to upward reserves while discharging. Note that as storage resources can contribute to regulation and reserves while either charging or discharging, the proxy variables <span>$f^{charge}_{o,z,t}, f^{discharge}_{o,z,t}$</span> and <span>$r^{charge}_{o,z,t}, r^{discharge}_{o,z,t}$</span> are created for storage resources where the total contribution to regulation and reserves, <span>$f_{o,z,t}, r_{o,z,t}$</span> is the sum of the proxy variables. These constraints are created with the function <code>storage_symmetric_operational_reserves!()</code> in <code>storage_symmetric.jl</code>. <strong>Storage with asymmetric charge and discharge capacity</strong> For storage technologies with asymmetric charge and discharge capacities (all <span>$o \in \mathcal{O}^{asym}$</span>), charge rate, <span>$\Pi_{o,z,t}$</span>, is constrained by the total installed charge capacity, <span>$\Delta^{total, charge}_{o,z}$</span>, as follows:</p><p class="math-container">\[\begin{aligned}
	&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} \leq \Delta^{total, charge}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{asym}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>These constraints are created with the function <code>storage_asymmetric()</code> in <code>storage_asymmetric.jl</code>. If reserves are modeled, the above constraint is replaced by the following:</p><p class="math-container">\[\begin{aligned}
	&amp;  \Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + f^{charge}_{o,z,t} \leq \Delta^{total, charge}_{o,z} &amp; \quad \forall o \in \mathcal{O}^{asym}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>where <span>$f^{+}_{y=o,z,t}$</span> is the contribution of storage resources to frequency regulation while charging. These constraints are created with the function <code>storage_symmetric_operational_reserves!()</code> in <code>storage_asymmetric.jl</code>. <strong>All storage resources</strong> The following constraints apply to all storage resources, <span>$o \in \mathcal{O}$</span>, regardless of whether the charge/discharge capacities are symmetric or asymmetric. The following two constraints track the state of charge of the storage resources at the end of each time period, relating the volume of energy stored at the end of the time period, <span>$\Gamma_{o,z,t}$</span>, to the state of charge at the end of the prior time period, <span>$\Gamma_{o,z,t-1}$</span>, the charge and discharge decisions in the current time period, <span>$\Pi_{o,z,t}, \Theta_{o,z,t}$</span>, and the self discharge rate for the storage resource (if any), <span>$\eta_{o,z}^{loss}$</span>.  The first of these two constraints enforces storage inventory balance for interior time steps <span>$(t \in \mathcal{T}^{interior})$</span>, while the second enforces storage balance constraint for the initial time step <span>$(t \in \mathcal{T}^{start})$</span>.</p><p class="math-container">\[\begin{aligned}
	&amp;  \Gamma_{o,z,t} =\Gamma_{o,z,t-1} - \frac{1}{\eta_{o,z}^{discharge}}\Theta_{o,z,t} + \eta_{o,z}^{charge}\Pi_{o,z,t} - \eta_{o,z}^{loss}\Gamma_{o,z,t-1}  \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}^{interior}\\
	&amp;  \Gamma_{o,z,t} =\Gamma_{o,z,t+\tau^{period}-1} - \frac{1}{\eta_{o,z}^{discharge}}\Theta_{o,z,t} + \eta_{o,z}^{charge}\Pi_{o,z,t} - \eta_{o,z}^{loss}\Gamma_{o,z,t+\tau^{period}-1}  \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}^{start}
\end{aligned}\]</p><p>If a capacity reserve margin is modeled, then the following constraints track the relationship between the virtual charge, <span>$\Pi^{CRM}_{o,z,t}$</span>, and virtual discharge, <span>$\Theta^{CRM}_{o,z,t}$</span>, variables and a third variable, <span>$\Gamma^{CRM}_{o,z,t}$</span>, representing the amount of state of charge that must be held in reserve to enable these virtual capacity reserve margin contributions, ensuring that the storage device could deliver its pledged capacity if called upon to do so without affecting its operations in other timesteps. <span>$\Gamma^{CRM}_{o,z,t}$</span> is tracked similarly to the devices overall state of charge based on its value in the previous timestep and the virtual charge and discharge in the current timestep. Unlike the regular state of charge, virtual discharge <span>$\Theta^{CRM}_{o,z,t}$</span> increases <span>$\Gamma^{CRM}_{o,z,t}$</span> (as more charge must be held in reserve to support more virtual discharge), and <span>$\Pi^{CRM}_{o,z,t}$</span> reduces <span>$\Gamma^{CRM}_{o,z,t}$</span>.</p><p class="math-container">\[\begin{aligned}
	&amp;  \Gamma^{CRM}_{o,z,t} =\Gamma^{CRM}_{o,z,t-1} + \frac{1}{\eta_{o,z}^{discharge}}\Theta^{CRM}_{o,z,t} - \eta_{o,z}^{charge}\Pi^{CRM}_{o,z,t} - \eta_{o,z}^{loss}\Gamma^{CRM}_{o,z,t-1}  \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}^{interior}\\
	&amp;  \Gamma^{CRM}_{o,z,t} =\Gamma^{CRM}_{o,z,t+\tau^{period}-1} + \frac{1}{\eta_{o,z}^{discharge}}\Theta^{CRM}_{o,z,t} - \eta_{o,z}^{charge}\Pi^{CRM}_{o,z,t} - \eta_{o,z}^{loss}\Gamma^{CRM}_{o,z,t+\tau^{period}-1}  \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}^{start}
\end{aligned}\]</p><p>The energy held in reserve, <span>$\Gamma^{CRM}_{o,z,t}$</span>, also acts as a lower bound on the overall state of charge <span>$\Gamma_{o,z,t}$</span>. This ensures that the storage device cannot use state of charge that would not have been available had it been called on to actually contribute its pledged virtual discharge at some earlier timestep. This relationship is described by the following equation:</p><p class="math-container">\[\begin{aligned}
	&amp;  \Gamma_{o,z,t} \geq \Gamma^{CRM}_{o,z,t} 
\end{aligned}\]</p><p>When modeling the entire year as a single chronological period with total number of time steps of <span>$\tau^{period}$</span>, storage inventory in the first time step is linked to storage inventory at the last time step of the period representing the year. Alternatively, when modeling the entire year with multiple representative periods, this constraint relates storage inventory in the first timestep of the representative period with the inventory at the last time step of the representative period, where each representative period is made of <span>$\tau^{period}$</span> time steps. In this implementation, energy exchange between representative periods is not permitted. When modeling representative time periods, GenX enables modeling of long duration energy storage which tracks state of charge (and state of charge held in reserve, if a capacity reserve margin is being modeled) between representative periods enable energy to be moved throughout the year. If there is more than one representative period and <code>LDS</code> has been enabled for resources in <code>Generators.csv</code>, this function calls <code>long_duration_storage()</code> in <code>long_duration_storage.jl</code> to enable this feature. The next constraint limits the volume of energy stored at any time, <span>$\Gamma_{o,z,t}$</span>, to be less than the installed energy storage capacity, <span>$\Delta^{total, energy}_{o,z}$</span>. Finally, the maximum combined discharge and virtual discharge rate for storage resources, <span>$\Pi_{o,z,t} + \Pi^{CRM}_{o,z,t}$</span>, is constrained to be less than the discharge power capacity, <span>$\Omega_{o,z,t}$</span> or the state of charge at the end of the last period, <span>$\Gamma_{o,z,t-1}$</span>, whichever is less.</p><p class="math-container">\[\begin{aligned}
	&amp;  \Gamma_{o,z,t} \leq \Delta^{total, energy}_{o,z} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} \leq \Gamma_{o,z,t-1} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>The above constraints are established in <code>storage_all!()</code> in <code>storage_all.jl</code>. If reserves are modeled, two pairs of proxy variables <span>$f^{charge}_{o,z,t}, f^{discharge}_{o,z,t}$</span> and <span>$r^{charge}_{o,z,t}, r^{discharge}_{o,z,t}$</span> are created for storage resources, to denote the contribution of storage resources to regulation or reserves while charging or discharging, respectively. The total contribution to regulation and reserves, <span>$f_{o,z,t}, r_{o,z,t}$</span> is then the sum of the proxy variables:</p><p class="math-container">\[\begin{aligned}
	&amp;  f_{o,z,t} = f^{charge}_{o,z,t} + f^{dicharge}_{o,z,t} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  r_{o,z,t} = r^{charge}_{o,z,t} + r^{dicharge}_{o,z,t} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>The total storage contribution to frequency regulation (<span>$f_{o,z,t}$</span>) and reserves (<span>$r_{o,z,t}$</span>) are each limited specified fraction of installed discharge power capacity (<span>$\upsilon^{reg}_{y,z}, \upsilon^{rsv}_{y,z}$</span>), reflecting the maximum ramp rate for the storage resource in whatever time interval defines the requisite response time for the regulation or reserve products (e.g., 5 mins or 15 mins or 30 mins). These response times differ by system operator and reserve product, and so the user should define these parameters in a self-consistent way for whatever system context they are modeling.</p><p class="math-container">\[\begin{aligned}
	f_{y,z,t} \leq \upsilon^{reg}_{y,z} \times \Delta^{total}_{y,z}
	\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T} \\
	r_{y,z, t} \leq \upsilon^{rsv}_{y,z}\times \Delta^{total}_{y,z}
	\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
	\end{aligned}\]</p><p>When charging, reducing the charge rate is contributing to upwards reserve and frequency regulation as it drops net demand. As such, the sum of the charge rate plus contribution to regulation and reserves up must be greater than zero. Additionally, the discharge rate plus the contribution to regulation must be greater than zero.</p><p class="math-container">\[\begin{aligned}
	&amp;  \Pi_{o,z,t} - f^{charge}_{o,z,t} - r^{charge}_{o,z,t} \geq 0 &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  \Theta_{o,z,t} - f^{discharge}_{o,z,t} \geq 0 &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>Additionally, when reserves are modeled, the maximum charge rate, virtual charge rate, and contribution to regulation while charging can be no greater than the available energy storage capacity, or the difference between the total energy storage capacity, <span>$\Delta^{total, energy}_{o,z}$</span>, and the state of charge at the end of the previous time period, <span>$\Gamma_{o,z,t-1}$</span>, while accounting for charging losses <span>$\eta_{o,z}^{charge}$</span>. Note that for storage to contribute to reserves down while charging, the storage device must be capable of increasing the charge rate (which increase net load).</p><p class="math-container">\[\begin{aligned}
	&amp;  \eta_{o,z}^{charge} \times (\Pi_{o,z,t} + \Pi^{CRM}_{o,z,t} + f^{charge}_{o,z,t}) \leq \Delta^{energy, total}_{o,z} - \Gamma_{o,z,t-1} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>Finally, the constraints on maximum discharge rate are replaced by the following, to account for capacity contributed to regulation and reserves:</p><p class="math-container">\[\begin{aligned}
	&amp;  \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} + f^{discharge}_{o,z,t} + r^{discharge}_{o,z,t} \leq \Delta^{total}_{o,z} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}\\
	&amp;  \Theta_{o,z,t} + \Theta^{CRM}_{o,z,t} + f^{discharge}_{o,z,t} + r^{discharge}_{o,z,t} \leq \Gamma_{o,z,t-1} &amp; \quad \forall o \in \mathcal{O}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>The above reserve related constraints are established by <code>storage_all_operational_reserves!()</code> in <code>storage_all.jl</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GenXProject/GenX.jl/blob/5700e142bc324b65a3dca63573d0b01201403c42/src/model/resources/storage/storage.jl#L1-L130">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../retrofit/">« Retrofit</a><a class="docs-footer-nextpage" href="../investment_charge/">Investment Charge »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 22 January 2025 20:10">Wednesday 22 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
