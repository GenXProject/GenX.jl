<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Configure multi-stage inputs · GenX.jl</title><meta name="title" content="Configure multi-stage inputs · GenX.jl"/><meta property="og:title" content="Configure multi-stage inputs · GenX.jl"/><meta property="twitter:title" content="Configure multi-stage inputs · GenX.jl"/><meta name="description" content="Documentation for GenX.jl."/><meta property="og:description" content="Documentation for GenX.jl."/><meta property="twitter:description" content="Documentation for GenX.jl."/><meta property="og:url" content="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Multi_Stage/configure_multi_stage_inputs/"/><meta property="twitter:url" content="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Multi_Stage/configure_multi_stage_inputs/"/><link rel="canonical" href="https://genxproject.github.io/GenX.jl/stable/Model_Reference/Multi_Stage/configure_multi_stage_inputs/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/genx_style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="GenX.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="GenX.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome Page</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">GenX: Introduction</a></li><li><a class="tocitem" href="../../../installation/">Installation Guide</a></li><li><a class="tocitem" href="../../../limitations_genx/">Limitation of GenX</a></li><li><a class="tocitem" href="../../../third_party_genx/">Third Party Extensions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Getting_Started/examples_casestudies/">Running GenX</a></li><li><a class="tocitem" href="../../../Getting_Started/commercial_solvers/">Commertial solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Tutorials/Tutorials_intro/">Tutorials Overview</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_1_configuring_settings/">Tutorial 1: Configuring Settings</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_2_network_visualization/">Tutorial 2: Network Visualization</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_3_K-means_time_domain_reduction/">Tutorial 3: K-Means and Time Domain Reduction</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_4_model_generation/">Tutorial 4: Model Generation</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_5_solve_model/">Tutorial 5: Solving the Model</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_6_solver_settings/">Tutorial 6: Solver Settings</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_7_setup/">Tutorial 7: Policy Constraints</a></li><li><a class="tocitem" href="../../../Tutorials/Tutorial_8_outputs/">Tutorial 8: Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../User_Guide/workflow/">Overall workflow</a></li><li><a class="tocitem" href="../../../User_Guide/model_configuration/">Model Configuration</a></li><li><a class="tocitem" href="../../../User_Guide/solver_configuration/">Solver Configuration</a></li><li><a class="tocitem" href="../../../User_Guide/model_input/">Model Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/TDR_input/">Time-domain Reduction Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/running_TDR/">Running the Time-domain Reduction</a></li><li><a class="tocitem" href="../../../User_Guide/generate_alternatives/">MGA package</a></li><li><a class="tocitem" href="../../../User_Guide/multi_stage_input/">Multi-stage Model</a></li><li><a class="tocitem" href="../../../User_Guide/slack_variables_overview/">Slack Variables for Policies</a></li><li><a class="tocitem" href="../../../User_Guide/methodofmorris_input/">Method of Morris Inputs</a></li><li><a class="tocitem" href="../../../User_Guide/running_model/">Running the Model</a></li><li><a class="tocitem" href="../../../User_Guide/model_output/">Model Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Model Concept and Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Model_Concept_Overview/model_introduction/">Model Introduction</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/model_notation/">Notation</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/objective_function/">Objective Function</a></li><li><a class="tocitem" href="../../../Model_Concept_Overview/power_balance/">Power Balance</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Model Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../core/">Core</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Resources/curtailable_variable_renewable/">Curtailable Variable Renewable</a></li><li><a class="tocitem" href="../../Resources/flexible_demand/">Flexible Demand</a></li><li><input class="collapse-toggle" id="menuitem-6-2-3" type="checkbox"/><label class="tocitem" for="menuitem-6-2-3"><span class="docs-label">Hydro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Resources/hydro_res/">Hydro Reservoir</a></li><li><a class="tocitem" href="../../Resources/hydro_inter_period_linkage/">Long Duration Hydro</a></li></ul></li><li><a class="tocitem" href="../../Resources/must_run/">Must Run</a></li><li><a class="tocitem" href="../../Resources/retrofit/">Retrofit</a></li><li><input class="collapse-toggle" id="menuitem-6-2-6" type="checkbox"/><label class="tocitem" for="menuitem-6-2-6"><span class="docs-label">Storage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Resources/storage/">Storage</a></li><li><a class="tocitem" href="../../Resources/investment_charge/">Investment Charge</a></li><li><a class="tocitem" href="../../Resources/investment_energy/">Investment Energy</a></li><li><a class="tocitem" href="../../Resources/long_duration_storage/">Long Duration Storage</a></li><li><a class="tocitem" href="../../Resources/storage_all/">Storage All</a></li><li><a class="tocitem" href="../../Resources/storage_asymmetric/">Storage Asymmetric</a></li><li><a class="tocitem" href="../../Resources/storage_symmetric/">Storage Symmetric</a></li></ul></li><li><a class="tocitem" href="../../Resources/vre_stor/">Co-located VRE and Storage</a></li><li><input class="collapse-toggle" id="menuitem-6-2-8" type="checkbox"/><label class="tocitem" for="menuitem-6-2-8"><span class="docs-label">Thermal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Resources/thermal/">Thermal</a></li><li><a class="tocitem" href="../../Resources/thermal_commit/">Thermal Commit</a></li><li><a class="tocitem" href="../../Resources/thermal_no_commit/">Thermal No Commit</a></li><li><a class="tocitem" href="../../Resources/maintenance/">Scheduled maintenance for Thermal Commit</a></li><li><a class="tocitem" href="../../Resources/fusion/">Fusion</a></li></ul></li><li><a class="tocitem" href="../../Resources/electrolyzers/">Hydrogen Electrolyzers</a></li><li><a class="tocitem" href="../../Resources/resource/">Resource types</a></li></ul></li><li><a class="tocitem" href="../../policies/">Policies</a></li><li><a class="tocitem" href="../../solver_configuration_api/">Solver Configurations</a></li><li><a class="tocitem" href="../../load_inputs/">Inputs Functions</a></li><li><a class="tocitem" href="../../generate_model/">Generate the Model</a></li><li><a class="tocitem" href="../../solve_model/">Solving the Model</a></li><li><a class="tocitem" href="../../TDR/">Time-domain Reduction</a></li><li><a class="tocitem" href="../../write_outputs/">Outputs Functions</a></li><li><a class="tocitem" href="../../mga/">Modeling to Generate Alternatives</a></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox" checked/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Multi-stage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../multi_stage_overview/">Multi-Stage Modeling Introduction</a></li><li class="is-active"><a class="tocitem" href>Configure multi-stage inputs</a></li><li><a class="tocitem" href="../dual_dynamic_programming/">Model multi stage: Dual Dynamic Programming Algorithm</a></li><li><a class="tocitem" href="../endogenous_retirement/">Endogenous Retirement</a></li></ul></li><li><a class="tocitem" href="../../methodofmorris/">Method of Morris</a></li><li><a class="tocitem" href="../../utility_functions/">Utility Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Public API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Public_API/public_api/">Public API</a></li></ul></li><li><a class="tocitem" href="../../../additional_third_party_extensions/">Third Party Extensions</a></li><li><a class="tocitem" href="../../../developer_guide/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Reference</a></li><li><a class="is-disabled">Multi-stage</a></li><li class="is-active"><a href>Configure multi-stage inputs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Configure multi-stage inputs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl/blob/main/docs/src/Model_Reference/Multi_Stage/configure_multi_stage_inputs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Configure-multi-stage-inputs"><a class="docs-heading-anchor" href="#Configure-multi-stage-inputs">Configure multi stage inputs</a><a id="Configure-multi-stage-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Configure-multi-stage-inputs" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GenX.compute_overnight_capital_cost-Tuple{Dict, Array, Array, Array}" href="#GenX.compute_overnight_capital_cost-Tuple{Dict, Array, Array, Array}"><code>GenX.compute_overnight_capital_cost</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function compute_overnight_capital_cost(settings_d::Dict,inv_costs_yr::Array,crp::Array,tech_wacc::Array)</code></pre><p>This function computes overnight capital costs incured within the model horizon, assuming that annualized costs to be paid after the model horizon are fully recoverable, and so are not included in the cost computation.</p><p>For each resource <span>$y \in \mathcal{G}$</span> with annualized investment cost <span>$AIC_{y}$</span> and capital recovery period <span>$CRP_{y}$</span>, overnight capital costs <span>$OCC_{y}$</span> are computed as follows:</p><p class="math-container">\[\begin{aligned}
    &amp; OCC_{y} = \sum^{min(CRP_{y},H)}_{i=1}\frac{AIC_{y}}{(1+WACC_{y})^{i}}
\end{aligned}\]</p><p>where <span>$WACC_y$</span> is the technology-specific weighted average cost of capital (set by the &quot;WACC&quot; field in the Generators_data.csv or Network.csv files), <span>$H$</span> is the number of years remaining between the start of the current model stage and the model horizon (the end of the final model stage) and <span>$CRP_y$</span> is the capital recovery period for technology <span>$y$</span> (specified in Generators_data.csv).</p><p>inputs:</p><ul><li>settings_d - dict object containing settings dictionary configured in the multi-stage settings file multi_stage_settings.yml.</li><li>inv_costs_yr - array object containing annualized investment costs.</li><li>crp - array object of capital recovery period values.</li><li>tech_wacc - array object containing technology-specific weighted costs of capital.</li></ul><p>NOTE: The inv_costs_yr and crp arrays must be the same length; values with the same index in each array correspond to the same resource <span>$y \in \mathcal{G}$</span>.</p><p>returns: array object containing overnight capital costs, the discounted sum of annual investment costs incured within the model horizon.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GenXProject/GenX.jl/blob/5700e142bc324b65a3dca63573d0b01201403c42/src/multi_stage/configure_multi_stage_inputs.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GenX.configure_multi_stage_inputs-Tuple{Dict, Dict, Int64}" href="#GenX.configure_multi_stage_inputs-Tuple{Dict, Dict, Int64}"><code>GenX.configure_multi_stage_inputs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function configure_multi_stage_inputs(inputs_d::Dict, settings_d::Dict, NetworkExpansion::Int64)</code></pre><p>This function overwrites input parameters read in via the load_inputs() method for proper configuration of multi-stage modeling:</p><ol><li><p>Overnight capital costs are computed via the compute_overnight_capital_cost() method and overwrite internal model representations of annualized investment costs.</p></li><li><p>Annualized fixed O&amp;M costs are scaled up to represent total fixed O&amp;M incured over the length of each model stage (specified by &quot;StageLength&quot; field in multi_stage_settings.yml).</p></li><li><p>Internal set representations of resources eligible for capacity retirements are overwritten to ensure compatability with multi-stage modeling.</p></li><li><p>When NetworkExpansion is active and there are multiple model zones, parameters related to transmission and network expansion are updated. First, annualized transmission reinforcement costs are converted into overnight capital costs. Next, the maximum allowable transmission line reinforcement parameter is overwritten by the model stage-specific value specified in the &quot;Line_Max_Flow_Possible_MW&quot; fields in the network_multi_stage.csv file. Finally, internal representations of lines eligible or not eligible for transmission expansion are overwritten based on the updated maximum allowable transmission line reinforcement parameters.</p></li></ol><p>inputs:</p><ul><li>inputs_d - dict object containing model inputs dictionary generated by load_inputs().</li><li>settings_d - dict object containing settings dictionary configured in the multi-stage settings file multi_stage_settings.yml.</li><li>NetworkExpansion - integer flag (0/1) indicating whether network expansion is on, set via the &quot;NetworkExpansion&quot; field in genx_settings.yml.</li></ul><p>returns: dictionary containing updated model inputs, to be used in the generate_model() method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GenXProject/GenX.jl/blob/5700e142bc324b65a3dca63573d0b01201403c42/src/multi_stage/configure_multi_stage_inputs.jl#L62-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GenX.validate_can_retire_multistage-Tuple{Dict, Int64}" href="#GenX.validate_can_retire_multistage-Tuple{Dict, Int64}"><code>GenX.validate_can_retire_multistage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">validate_can_retire_multistage(inputs_dict::Dict, num_stages::Int)</code></pre><p>This function validates that all the resources do not switch from havig <code>can_retire = 0</code> to <code>can_retire = 1</code> during the multi-stage optimization.</p><p><strong>Arguments</strong></p><ul><li><code>inputs_dict::Dict</code>: A dictionary containing the inputs for each stage.</li><li><code>num_stages::Int</code>: The number of stages in the multi-stage optimization.</li></ul><p><strong>Returns</strong></p><ul><li>Throws an error if a resource switches from <code>can_retire = 0</code> to <code>can_retire = 1</code> between stages.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GenXProject/GenX.jl/blob/5700e142bc324b65a3dca63573d0b01201403c42/src/multi_stage/configure_multi_stage_inputs.jl#L235-L246">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multi_stage_overview/">« Multi-Stage Modeling Introduction</a><a class="docs-footer-nextpage" href="../dual_dynamic_programming/">Model multi stage: Dual Dynamic Programming Algorithm »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 22 January 2025 20:10">Wednesday 22 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
