<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 3: K-Means and Time Domain Reduction · GenX.jl</title><meta name="title" content="Tutorial 3: K-Means and Time Domain Reduction · GenX.jl"/><meta property="og:title" content="Tutorial 3: K-Means and Time Domain Reduction · GenX.jl"/><meta property="twitter:title" content="Tutorial 3: K-Means and Time Domain Reduction · GenX.jl"/><meta name="description" content="Documentation for GenX.jl."/><meta property="og:description" content="Documentation for GenX.jl."/><meta property="twitter:description" content="Documentation for GenX.jl."/><meta property="og:url" content="https://genxproject.github.io/GenX.jl/stable/Tutorials/Tutorial_3_K-means_time_domain_reduction/"/><meta property="twitter:url" content="https://genxproject.github.io/GenX.jl/stable/Tutorials/Tutorial_3_K-means_time_domain_reduction/"/><link rel="canonical" href="https://genxproject.github.io/GenX.jl/stable/Tutorials/Tutorial_3_K-means_time_domain_reduction/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/genx_style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="GenX.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="GenX.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome Page</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">GenX: Introduction</a></li><li><a class="tocitem" href="../../installation/">Installation Guide</a></li><li><a class="tocitem" href="../../limitations_genx/">Limitation of GenX</a></li><li><a class="tocitem" href="../../third_party_genx/">Third Party Extensions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Getting_Started/examples_casestudies/">Running GenX</a></li><li><a class="tocitem" href="../../Getting_Started/commercial_solvers/">Commertial solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Tutorials_intro/">Tutorials Overview</a></li><li><a class="tocitem" href="../Tutorial_1_configuring_settings/">Tutorial 1: Configuring Settings</a></li><li><a class="tocitem" href="../Tutorial_2_network_visualization/">Tutorial 2: Network Visualization</a></li><li class="is-active"><a class="tocitem" href>Tutorial 3: K-Means and Time Domain Reduction</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Find-array-of-unique-representative-periods"><span>Find array of unique representative periods</span></a></li><li class="toplevel"><a class="tocitem" href="#Create-an-array-of-the-time-steps-and-MW-values-of-each-representative-period"><span>Create an array of the time steps and MW values of each representative period</span></a></li><li class="toplevel"><a class="tocitem" href="#Combine-with-Total-(pre-TDR)"><span>Combine with Total (pre TDR)</span></a></li><li class="toplevel"><a class="tocitem" href="#Add-column-names-and-convert-column-type"><span>Add column names and convert column type</span></a></li><li class="toplevel"><a class="tocitem" href="#Define-a-new-color-scheme-to-accomodate-more-periods"><span>Define a new color scheme to accomodate more periods</span></a></li><li class="toplevel"><a class="tocitem" href="#Change-MinPeriods-and-Max-Periods,-run-Run.jl"><span>Change MinPeriods and Max Periods, run <code>Run.jl</code></span></a></li><li class="toplevel"><a class="tocitem" href="#For-simplicity,-keep-min-and-max-periods-the-same"><span>For simplicity, keep min and max periods the same</span></a></li><li class="toplevel"><a class="tocitem" href="#Find-objective-values-from-each-results-folder:"><span>Find objective values from each results folder:</span></a></li><li class="toplevel"><a class="tocitem" href="#Isolate-the-objective-values-from-the-data-frame"><span>Isolate the objective values from the data frame</span></a></li><li class="toplevel"><a class="tocitem" href="#Take-the-absolute-difference-between-the-original-objective-value-and-the-new-ones"><span>Take the absolute difference between the original objective value and the new ones</span></a></li><li class="toplevel"><a class="tocitem" href="#Plot-the-differences-as-a-function-of-number-of-representative-periods"><span>Plot the differences as a function of number of representative periods</span></a></li></ul></li><li><a class="tocitem" href="../Tutorial_4_model_generation/">Tutorial 4: Model Generation</a></li><li><a class="tocitem" href="../Tutorial_5_solve_model/">Tutorial 5: Solving the Model</a></li><li><a class="tocitem" href="../Tutorial_6_solver_settings/">Tutorial 6: Solver Settings</a></li><li><a class="tocitem" href="../Tutorial_7_setup/">Tutorial 7: Policy Constraints</a></li><li><a class="tocitem" href="../Tutorial_8_outputs/">Tutorial 8: Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../User_Guide/workflow/">Overall workflow</a></li><li><a class="tocitem" href="../../User_Guide/model_configuration/">Model Configuration</a></li><li><a class="tocitem" href="../../User_Guide/solver_configuration/">Solver Configuration</a></li><li><a class="tocitem" href="../../User_Guide/model_input/">Model Inputs</a></li><li><a class="tocitem" href="../../User_Guide/TDR_input/">Time-domain Reduction Inputs</a></li><li><a class="tocitem" href="../../User_Guide/running_TDR/">Running the Time-domain Reduction</a></li><li><a class="tocitem" href="../../User_Guide/generate_alternatives/">MGA package</a></li><li><a class="tocitem" href="../../User_Guide/multi_stage_input/">Multi-stage Model</a></li><li><a class="tocitem" href="../../User_Guide/slack_variables_overview/">Slack Variables for Policies</a></li><li><a class="tocitem" href="../../User_Guide/methodofmorris_input/">Method of Morris Inputs</a></li><li><a class="tocitem" href="../../User_Guide/running_model/">Running the Model</a></li><li><a class="tocitem" href="../../User_Guide/model_output/">Model Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Model Concept and Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Concept_Overview/model_introduction/">Model Introduction</a></li><li><a class="tocitem" href="../../Model_Concept_Overview/model_notation/">Notation</a></li><li><a class="tocitem" href="../../Model_Concept_Overview/objective_function/">Objective Function</a></li><li><a class="tocitem" href="../../Model_Concept_Overview/power_balance/">Power Balance</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Model Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/core/">Core</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/Resources/curtailable_variable_renewable/">Curtailable Variable Renewable</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/flexible_demand/">Flexible Demand</a></li><li><input class="collapse-toggle" id="menuitem-6-2-3" type="checkbox"/><label class="tocitem" for="menuitem-6-2-3"><span class="docs-label">Hydro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/Resources/hydro_res/">Hydro Reservoir</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/hydro_inter_period_linkage/">Long Duration Hydro</a></li></ul></li><li><a class="tocitem" href="../../Model_Reference/Resources/must_run/">Must Run</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/retrofit/">Retrofit</a></li><li><input class="collapse-toggle" id="menuitem-6-2-6" type="checkbox"/><label class="tocitem" for="menuitem-6-2-6"><span class="docs-label">Storage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/Resources/storage/">Storage</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/investment_charge/">Investment Charge</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/investment_energy/">Investment Energy</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/long_duration_storage/">Long Duration Storage</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/storage_all/">Storage All</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/storage_asymmetric/">Storage Asymmetric</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/storage_symmetric/">Storage Symmetric</a></li></ul></li><li><a class="tocitem" href="../../Model_Reference/Resources/vre_stor/">Co-located VRE and Storage</a></li><li><input class="collapse-toggle" id="menuitem-6-2-8" type="checkbox"/><label class="tocitem" for="menuitem-6-2-8"><span class="docs-label">Thermal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/Resources/thermal/">Thermal</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/thermal_commit/">Thermal Commit</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/thermal_no_commit/">Thermal No Commit</a></li></ul></li><li><a class="tocitem" href="../../Model_Reference/Resources/electrolyzers/">Hydrogen Electrolyzers</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/maintenance/">Scheduled maintenance for various resources</a></li><li><a class="tocitem" href="../../Model_Reference/Resources/resource/">Resource types</a></li></ul></li><li><a class="tocitem" href="../../Model_Reference/maintenance_overview/">Maintenance</a></li><li><a class="tocitem" href="../../Model_Reference/policies/">Policies</a></li><li><a class="tocitem" href="../../Model_Reference/solver_configuration_api/">Solver Configurations</a></li><li><a class="tocitem" href="../../Model_Reference/load_inputs/">Inputs Functions</a></li><li><a class="tocitem" href="../../Model_Reference/generate_model/">Generate the Model</a></li><li><a class="tocitem" href="../../Model_Reference/solve_model/">Solving the Model</a></li><li><a class="tocitem" href="../../Model_Reference/TDR/">Time-domain Reduction</a></li><li><a class="tocitem" href="../../Model_Reference/write_outputs/">Outputs Functions</a></li><li><a class="tocitem" href="../../Model_Reference/mga/">Modeling to Generate Alternatives</a></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Multi-stage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Model_Reference/Multi_Stage/multi_stage_overview/">Multi-Stage Modeling Introduction</a></li><li><a class="tocitem" href="../../Model_Reference/Multi_Stage/configure_multi_stage_inputs/">Configure multi-stage inputs</a></li><li><a class="tocitem" href="../../Model_Reference/Multi_Stage/dual_dynamic_programming/">Model multi stage: Dual Dynamic Programming Algorithm</a></li><li><a class="tocitem" href="../../Model_Reference/Multi_Stage/endogenous_retirement/">Endogenous Retirement</a></li></ul></li><li><a class="tocitem" href="../../Model_Reference/methodofmorris/">Method of Morris</a></li><li><a class="tocitem" href="../../Model_Reference/utility_functions/">Utility Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Public API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Public_API/public_api/">Public API</a></li></ul></li><li><a class="tocitem" href="../../additional_third_party_extensions/">Third Party Extensions</a></li><li><a class="tocitem" href="../../developer_guide/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Tutorial 3: K-Means and Time Domain Reduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial 3: K-Means and Time Domain Reduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GenXProject/GenX.jl/blob/main/docs/src/Tutorials/Tutorial_3_K-means_time_domain_reduction.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-3:-K-Means-and-Time-Domain-Reduction"><a class="docs-heading-anchor" href="#Tutorial-3:-K-Means-and-Time-Domain-Reduction">Tutorial 3: K-Means and Time Domain Reduction</a><a id="Tutorial-3:-K-Means-and-Time-Domain-Reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-3:-K-Means-and-Time-Domain-Reduction" title="Permalink"></a></h1><p><a href="https://github.com/GenXProject/GenX-Tutorials/blob/main/Tutorials/Tutorial_3_K-means_Time_Domain_Reduction.ipynb">Interactive Notebook of the tutorial</a></p><p>A good tool to reduce computation time of GenX is to use <a href="../../User_Guide/TDR_input/#Time-domain-reduction">Time-domain reduction</a>. Time-domain Reduction is a method that selects a smaller set of time steps from the data in a way that reduces computation time while still capturing the main information of the model. In this tutorial, we go over how TDR works in GenX and how it uses K-means clustering to choose the optimal time steps. For more information on TDR in capacity expansion models, see <a href="https://www.sciencedirect.com/science/article/pii/S0360544218315238">Mallapragada et al</a>.</p><h3 id="Table-of-Contents"><a class="docs-heading-anchor" href="#Table-of-Contents">Table of Contents</a><a id="Table-of-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-Contents" title="Permalink"></a></h3><ul><li><a href="#TDR">Time Domain Reduction</a></li><li><a href="#Kmeans">K-Means Clustering</a></li><li><a href="#TDRResults">Results of Time Domain Reduction</a></li><li><a href="#Reconstruction">Reconstruction</a></li><li><a href="#ExtPeriods">Extreme Periods</a></li><li><a href="#ObjVals">Objective Values and Representative Periods</a></li></ul><h3 id="Time-Domain-Reduction"><a class="docs-heading-anchor" href="#Time-Domain-Reduction">Time Domain Reduction</a><a id="Time-Domain-Reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Domain-Reduction" title="Permalink"></a></h3><p>To see how Time Domain Reduction works, let&#39;s look at the <code>Demand_data</code> in <code>example_systems/1_three_zones</code>:</p><pre><code class="language-julia hljs"># First, load all packages needed
using DataFrames
using CSV
using VegaLite
using YAML
using PlotlyJS
using Plots
using Clustering
using ScikitLearn
@sk_import datasets: (make_blobs)
</code></pre><p>julia case = joinpath(&quot;example<em>systems/1</em>three_zones&quot;);</p><pre><code class="nohighlight hljs"></code></pre><p>julia loads =  CSV.read(joinpath(case,&quot;system/Demand_data.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs"></code></pre><p>@raw html &lt;div&gt;&lt;div style = &quot;float: left;&quot;&gt;&lt;span&gt;8760×12 DataFrame&lt;/span&gt;&lt;/div&gt;&lt;div style = &quot;float: right;&quot;&gt;&lt;span style = &quot;font-style: italic;&quot;&gt;8735 rows omitted&lt;/span&gt;&lt;/div&gt;&lt;div style = &quot;clear: both;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class = &quot;data-frame&quot; style = &quot;overflow-x: scroll;&quot;&gt;&lt;table class = &quot;data-frame&quot; style = &quot;margin-bottom: 6px;&quot;&gt;&lt;thead&gt;&lt;tr class = &quot;header&quot;&gt;&lt;th class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;Row&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Voll&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Demand<em>Segment&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Cost</em>of<em>Demand</em>Curtailment<em>per</em>MW&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Max<em>Demand</em>Curtailment&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;/MWh&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Rep<em>Periods&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Timesteps</em>per<em>Rep</em>Period&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Sub<em>Weights&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Time</em>Index&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Demand<em>MW</em>z1&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Demand<em>MW</em>z2&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Demand<em>MW</em>z3&lt;/th&gt;&lt;/tr&gt;&lt;tr class = &quot;subheader headerLastRow&quot;&gt;&lt;th class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;String3&quot; style = &quot;text-align: left;&quot;&gt;String3&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;String3&quot; style = &quot;text-align: left;&quot;&gt;String3&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;String7&quot; style = &quot;text-align: left;&quot;&gt;String7&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;50000&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;2000&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;8760&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;8760&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7850&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2242&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1070&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;2&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;2&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.9&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.04&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1800&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7424&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2120&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1012&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;3&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;3&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.55&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.024&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;1100&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7107&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2029&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;969&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.2&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;0.003&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;400&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;6947&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1984&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;947&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;5&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;5&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;6922&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1977&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;944&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;6&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;6&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7045&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2012&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;960&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;7&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7307&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2087&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;996&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7544&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2154&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1029&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;9&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;9&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7946&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2269&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1083&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;10&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8340&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2382&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1137&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;11&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8578&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2449&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1169&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8666&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2474&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1181&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;13&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;13&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8707&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2487&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1187&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8749&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8749&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10730&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3064&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1463&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8750&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8750&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10550&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3013&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1439&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8751&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8751&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10438&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2981&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1423&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8752&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8752&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10469&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2990&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1427&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8753&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8753&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11228&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3206&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1531&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8754&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8754&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11908&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3401&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1624&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8755&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8755&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11562&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3302&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1576&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8756&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8756&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;9923&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3797&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1339&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8757&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8757&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;9461&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3621&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1277&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8758&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8758&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;9018&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3452&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1217&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8759&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8759&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8551&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3281&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1154&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8760&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: left;&quot;&gt;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8760&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8089&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3106&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1092&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;</p><pre><code class="nohighlight hljs">

The columns to note in this file are `Rep_Periods`, `TimeSteps_Per_Rep_Period`, `Time_Index`, and `Demand_MW_`. This file shows the number of time steps used in GenX before applying TDR, i.e. every hour in a year, totaling 8,760 hours. This means that there is only one representative period, as seen in `Rep_Periods`.

TDR performs a &quot;reduction&quot; into a specified number of &quot;representative periods&quot;, paring down the input data into a smaller set. The representative periods are then used in the GenX algorithm in place of the entire input data to reduce computation time. The TDR algorithm selects the representative periods to be the set of data whose results in GenX best match the results of the entire input data. To do this, TDR using k-means clustering, described in the next section.

When TDR is used, the file `time_domain_reduction_settings.yml` is called with a variety of specified settings, shown below:

</code></pre><p>julia time<em>domain</em>reduction<em>settings = YAML.load(open(joinpath(case,&quot;settings/time</em>domain<em>reduction</em>settings.yml&quot;)))</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">Dict{Any, Any} with 15 entries:
  &quot;IterativelyAddPeriods&quot; =&gt; 1
  &quot;ExtremePeriods&quot;        =&gt; Dict{Any, Any}(&quot;Wind&quot;=&gt;Dict{Any, Any}(&quot;System&quot;=&gt;Di…
  &quot;UseExtremePeriods&quot;     =&gt; 1
  &quot;MinPeriods&quot;            =&gt; 8
  &quot;MaxPeriods&quot;            =&gt; 11
  &quot;DemandWeight&quot;          =&gt; 1
  &quot;ClusterFuelPrices&quot;     =&gt; 1
  &quot;nReps&quot;                 =&gt; 100
  &quot;MultiStageConcatenate&quot; =&gt; 0
  &quot;Threshold&quot;             =&gt; 0.05
  &quot;TimestepsPerRepPeriod&quot; =&gt; 168
  &quot;IterateMethod&quot;         =&gt; &quot;cluster&quot;
  &quot;ScalingMethod&quot;         =&gt; &quot;S&quot;
  &quot;ClusterMethod&quot;         =&gt; &quot;kmeans&quot;
  &quot;WeightTotal&quot;           =&gt; 8760</code></pre><pre><code class="nohighlight hljs">
Important here to note are `MinPeriods` and `MaxPeriods`. As TDR is performed, it is required to keep the number of representative periods to be between the min and max specified in the settings. This is to ensure that computation time is actually decreased and that the k-means algorithm doesn&#39;t just form one large cluster of all points. Additionally, `TimestepsPerRepPeriod` is set to 168, the number of hours in a week (`WeightTotal` includes all 8,760 timesteps, the number of hours in a year.) By specifying the number of timesteps in each representative period to be a week, we form 52 clusters from which the algorithm will choose 8-11.

For descriptions of all settings, see [`cluster_inputs`](@ref) in the documentation.

Now back to pre-TDR. Below shows the load per timestep in megawatts for the entire dataset, i.e. with only one representative period of 8760 hours. This is done for Zone 1:
</code></pre><p>julia loads |&gt; @vlplot(:line,      x=:Time<em>Index, y=:Demand</em>MW_z1, title=&quot;MW Load per hour, No TDR&quot;,     width=600,height=400,linewidth=.01)</p><pre><code class="nohighlight hljs">
![svg](./files/t3_demand.svg)

As in [Tutorial 1: Configuring Settings](@ref), we can open the `genx_settings.yml` file for `1_three_zones` to see how `TimeDomainReduction` is set. If it&#39;s set to 1, this means TDR is being used.
</code></pre><p>julia genx<em>settings</em>TZ = YAML.load(open((joinpath(case,&quot;settings/genx_settings.yml&quot;))))</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">Dict{Any, Any} with 19 entries:
  &quot;NetworkExpansion&quot;                        =&gt; 1
  &quot;ModelingToGenerateAlternativeIterations&quot; =&gt; 3
  &quot;ParameterScale&quot;                          =&gt; 1
  &quot;EnergyShareRequirement&quot;                  =&gt; 0
  &quot;PrintModel&quot;                              =&gt; 0
  &quot;TimeDomainReduction&quot;                     =&gt; 1
  &quot;Trans_Loss_Segments&quot;                     =&gt; 1
  &quot;CapacityReserveMargin&quot;                   =&gt; 0
  &quot;ModelingtoGenerateAlternativeSlack&quot;      =&gt; 0.1
  &quot;MethodofMorris&quot;                          =&gt; 0
  &quot;StorageLosses&quot;                           =&gt; 1
  &quot;MultiStage&quot;                              =&gt; 0
  &quot;OverwriteResults&quot;                        =&gt; 0
  &quot;UCommit&quot;                                 =&gt; 2
  &quot;ModelingToGenerateAlternatives&quot;          =&gt; 0
  &quot;MaxCapReq&quot;                               =&gt; 0
  &quot;MinCapReq&quot;                               =&gt; 1
  &quot;CO2Cap&quot;                                  =&gt; 2
  &quot;WriteShadowPrices&quot;                       =&gt; 1</code></pre><pre><code class="nohighlight hljs">
To visualize how TDR decreases computation time, let&#39;s start by running `example_systems/1_three_zones` without TDR. In the third section of this tutorial, we&#39;ll run the example again using TDR.

To run GenX without TDR, we start by editing the settings to set `TimeDomainReduction` to 0:

</code></pre><p>julia genx<em>settings</em>TZ[&quot;TimeDomainReduction&quot;] = 0 genx<em>settings</em>TZ ## Output settings</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">Dict{Any, Any} with 13 entries:
&quot;NetworkExpansion&quot;       =&gt; 1
&quot;ParameterScale&quot;         =&gt; 1
&quot;EnergyShareRequirement&quot; =&gt; 0
&quot;TimeDomainReduction&quot;    =&gt; 0
&quot;Trans_Loss_Segments&quot;    =&gt; 1
&quot;CapacityReserveMargin&quot;  =&gt; 0
&quot;StorageLosses&quot;          =&gt; 1
&quot;ComputeConflicts&quot;       =&gt; 1
&quot;UCommit&quot;                =&gt; 2
&quot;MaxCapReq&quot;              =&gt; 0
&quot;MinCapReq&quot;              =&gt; 1
&quot;CO2Cap&quot;                 =&gt; 2
&quot;WriteShadowPrices&quot;      =&gt; 1</code></pre><pre><code class="nohighlight hljs">
Then we write the edited settings to the file path:

</code></pre><p>julia YAML.write<em>file((joinpath(case,&quot;settings/genx</em>settings.yml&quot;)), genx<em>settings</em>TZ)</p><pre><code class="nohighlight hljs">
And run it using `include`. (Note: this process will take a few minutes):

</code></pre><p>julia @time include(&quot;example<em>systems/1</em>three_zones/Run.jl&quot;)</p><pre><code class="nohighlight hljs">Time elapsed for writing is
    142.404724 seconds

This took a little while to run, and would take even longer for larger systems. Let&#39;s see how we can get the run time down using Time Domain Reduction. The next sections go over how K-means clustering is used to perform TDR, and how to interpret the resulting files in GenX.

### K-means clustering

Let&#39;s go over how TDR works. To perform TDR, GenX uses __K-means clustering__. _K_-means is an optimization method that clusters data into several groups based on their proximity to &quot;centers&quot; determined by the algorithm. 

_K_-means finds a set number of groups such that the variance between the distance of each point in the group to the mean of the group is minimized. 
</code></pre><p>math \begin{align<em>} \mathop{\arg \min}\limits<em>{\mathbf{S}} &amp; \sum</em>{i = 1}^k \sum<em>{x \in S</em>i} ||x - \mu_i||^2 \
\end{align</em>}</p><pre><code class="nohighlight hljs">
Where $\mathbf{S} = \{S_1, ... , S_k\}$ are the clusters, with $x$ denoting the elements of the clusters, and $\mu_i$ the mean of each cluster, i.e. the mean of the distances from each point to the center of the cluster. By taking the argmin over $\mathbf{S}$, the points $x$ are clustered into groups where their distance to the center is the smallest. For more information on how _k_-means works, see the [Wikipedia](https://en.wikipedia.org/wiki/K-means_clustering). 

GenX uses the package `Clustering.jl`, with documentation [here](https://juliastats.org/Clustering.jl/dev/kmeans.html#K-means). As an example, using the package `ScikitLearn.jl`, let&#39;s generate data that can cluster easily.

</code></pre><p>julia centers = 5 X, y = make<em>blobs(n</em>samples=50,centers=centers); # From scikit-learn b = DataFrame(X,:auto)</p><pre><code class="nohighlight hljs">
Note that clustering works for data without obvious groupings, but using blobs as an example makes _k_-means easier to visualize.

</code></pre><p>julia plotly() Plots.scatter(b[!,&quot;x1&quot;],b[!,&quot;x2&quot;],legend=false,title=&quot;Before K-means Clustering&quot;)</p><pre><code class="nohighlight hljs">
![png](./files/t3_nokmeans.png)

Now we use the function `kmeans`, which is also used in `src/time_domain_reduction` in GenX.

</code></pre><p>julia R = kmeans(transpose(Matrix(b)),centers)</p><pre><code class="nohighlight hljs">
`kmeans` returns three outputs: assignments, centers, and counts. Assignments shows to which cluster each points belongs, centers shows where the center coordinates of each cluster are, and counts shows how many points belong to each cluster.

</code></pre><p>julia println(&quot;Assignments = &quot;,R.assignments) println(&quot;&quot;) println(&quot;Counts = &quot;,R.counts) println(&quot;&quot;) println(&quot;Centers:&quot;) R.centers</p><pre><code class="nohighlight hljs">
</code></pre><p>julia plotly() Plots.scatter(b[!,&quot;x1&quot;],b[!,&quot;x2&quot;],legend=false,marker_z=R.assignments,c=:lightrainbow,title=&quot;After K-means Clustering&quot;)</p><pre><code class="nohighlight hljs">
![png](./files/t3_kmeans.png)

In GenX, the representative periods are the centers of the clusters, each representing one week of the year. In the above example that would mean there are 52 data points gathered into 11 clusters (to see this for yourself, change `make_blobs` to have 52 data points and 11 clusters.)

### Results of Time Domain Reduction

To visualize the results of TDR, we&#39;ll set TDR = 1 back in the `genx_settings.yml` file in `example_systems/1_three_zones`:

</code></pre><p>julia genx<em>settings</em>TZ[&quot;TimeDomainReduction&quot;] = 1;</p><pre><code class="nohighlight hljs">
</code></pre><p>julia genx<em>settings</em>TZ</p><pre><code class="nohighlight hljs">
</code></pre><p>julia YAML.write<em>file((joinpath(case,&quot;settings/genx</em>settings.yml&quot;)), genx<em>settings</em>TZ)</p><pre><code class="nohighlight hljs">
And run GenX again with TDR:

</code></pre><p>julia @time include(&quot;example<em>systems/1</em>three_zones/Run.jl&quot;)</p><pre><code class="nohighlight hljs">
Csv files with the results of TDR are generated automatically in a folder called `TDR_results` found within the same folder containing the input csv files, in this case `example_systems/1_three_zones`. The csv files in this folder show the files used in `Run.jl` that have been pared down from the initial input files.

As an example, consider the input file `Fuels_data.csv`:

</code></pre><p>julia Fuels<em>original = CSV.read(joinpath(case,&quot;system/Fuels</em>data.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs">
Compared to `TDR_Results/Fuels_data.csv`:

</code></pre><p>julia Fuels<em>TDR = CSV.read(joinpath(case,&quot;TDR</em>Results/Fuels_data.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs">
As you can see, the original has all 8,760 hours, while the TDR version only has 1,848 hours.

</code></pre><p>julia loads<em>TDR = CSV.read(joinpath(case,&quot;TDR</em>Results/Demand_data.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs">
The 1,848 hours are divided into 11 sections of 168 hours, with each section representing one week of the original data.  The number of hours per representative period is set in `time_domain_reduction_settings.yml`. Also specified in the file are the minimum and maximum number of clusters we would like to have (in this case 8 and 11). The _k_-means algorithm will then select the number of clusters that should be sufficient to capture the GenX model in fewer time steps (in this case 11).

</code></pre><p>julia Gen<em>TDR = CSV.read(joinpath(case,&quot;TDR</em>Results/Generators_variability.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs">
</code></pre><p>julia generators = CSV.read(joinpath(case,&quot;system/Generators_variability.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs">
Below, we create arrays out of the representative weeks and plot them on the same plot used in the beginning of this tutorial. The file `Period_map` shows which periods (weeks) are used in TDR and which time step corresponds to each period:

</code></pre><p>julia Period<em>map = CSV.read(joinpath(case,&quot;TDR</em>Results/Period_map.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs"></code></pre><p>@raw html &lt;div&gt;&lt;div style = &quot;float: left;&quot;&gt;&lt;span&gt;52×3 DataFrame&lt;/span&gt;&lt;/div&gt;&lt;div style = &quot;float: right;&quot;&gt;&lt;span style = &quot;font-style: italic;&quot;&gt;27 rows omitted&lt;/span&gt;&lt;/div&gt;&lt;div style = &quot;clear: both;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class = &quot;data-frame&quot; style = &quot;overflow-x: scroll;&quot;&gt;&lt;table class = &quot;data-frame&quot; style = &quot;margin-bottom: 6px;&quot;&gt;&lt;thead&gt;&lt;tr class = &quot;header&quot;&gt;&lt;th class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;Row&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Period<em>Index&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Rep</em>Period&lt;/th&gt;&lt;th style = &quot;text-align: left;&quot;&gt;Rep<em>Period</em>Index&lt;/th&gt;&lt;/tr&gt;&lt;tr class = &quot;subheader headerLastRow&quot;&gt;&lt;th class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;th title = &quot;Int64&quot; style = &quot;text-align: left;&quot;&gt;Int64&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;2&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;3&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;5&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;5&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;6&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;6&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;7&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;7&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;9&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;9&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;10&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;11&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;13&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;13&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;12&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;&amp;vellip;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;41&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;41&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;20&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;5&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;42&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;42&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;20&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;5&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;43&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;43&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;23&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;6&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;44&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;44&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;17&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;4&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;45&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;45&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;46&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;46&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;47&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;47&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;48&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;49&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;49&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;49&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;50&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;50&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;49&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;11&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;51&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;51&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class = &quot;rowNumber&quot; style = &quot;font-weight: bold; text-align: right;&quot;&gt;52&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;52&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;8&lt;/td&gt;&lt;td style = &quot;text-align: right;&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;</p><pre><code class="nohighlight hljs"></code></pre><p>julia</p><h1 id="Find-array-of-unique-representative-periods"><a class="docs-heading-anchor" href="#Find-array-of-unique-representative-periods">Find array of unique representative periods</a><a id="Find-array-of-unique-representative-periods-1"></a><a class="docs-heading-anchor-permalink" href="#Find-array-of-unique-representative-periods" title="Permalink"></a></h1><p>rep<em>periods = unique(Period</em>map[!,&quot;Rep_Period&quot;])</p><h1 id="Create-an-array-of-the-time-steps-and-MW-values-of-each-representative-period"><a class="docs-heading-anchor" href="#Create-an-array-of-the-time-steps-and-MW-values-of-each-representative-period">Create an array of the time steps and MW values of each representative period</a><a id="Create-an-array-of-the-time-steps-and-MW-values-of-each-representative-period-1"></a><a class="docs-heading-anchor-permalink" href="#Create-an-array-of-the-time-steps-and-MW-values-of-each-representative-period" title="Permalink"></a></h1><p>weeks<em>load = [] for i in rep</em>periods     week<em>temp</em>loads = [repeat([i],168) loads[(168<em>i-167):168</em>i,&quot;Time<em>Index&quot;] loads[(168<em>i-167):168</em>i,&quot;Demand</em>MW<em>z1&quot;]]     weeks</em>load = [weeks<em>load; week</em>temp_loads] end</p><h1 id="Combine-with-Total-(pre-TDR)"><a class="docs-heading-anchor" href="#Combine-with-Total-(pre-TDR)">Combine with Total (pre TDR)</a><a id="Combine-with-Total-(pre-TDR)-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-with-Total-(pre-TDR)" title="Permalink"></a></h1><p>loads<em>plot = [repeat([&quot;Total&quot;],8760) loads[!,&quot;Time</em>Index&quot;] loads[!,&quot;Demand<em>MW</em>z1&quot;]];</p><h1 id="Add-column-names-and-convert-column-type"><a class="docs-heading-anchor" href="#Add-column-names-and-convert-column-type">Add column names and convert column type</a><a id="Add-column-names-and-convert-column-type-1"></a><a class="docs-heading-anchor-permalink" href="#Add-column-names-and-convert-column-type" title="Permalink"></a></h1><p>loads<em>with</em>TDR = [loads<em>plot; weeks</em>load] loads<em>with</em>TDR = DataFrame(loads<em>with</em>TDR ,[&quot;Week&quot;,&quot;hour&quot;, &quot;MW&quot;]) loads<em>with</em>TDR[!,:hour] = convert.(Int64,loads<em>with</em>TDR[!,:hour]); loads<em>with</em>TDR[!,:MW] = convert.(Float64,loads<em>with</em>TDR[!,:MW]);</p><pre><code class="nohighlight hljs">
</code></pre><p>julia loads<em>with</em>TDR  |&gt; @vlplot(mark={:line},     x={:hour,title=&quot;Time Step (hours)&quot;,labels=&quot;Week:n&quot;}, y={:MW,title=&quot;Load (MW)&quot;},     color={&quot;Week:n&quot;, scale={scheme=&quot;paired&quot;},sort=&quot;decsending&quot;}, title=&quot;MW Load per hour with TDR Representative Weeks&quot;,     width=845,height=400)</p><pre><code class="nohighlight hljs">![svg](./files/t3_TDR_demand.svg)

TDR is performed for four total data sets: demand (found in Demand.csv), wind and solar (found in Generators_variability.csv), and fuel prices (found in Fuels.csv). Above is just the demand load for one of the three total nodes in the example system, which is why the data may not appear to &quot;represent&quot; all 52 weeks (notice there are fewer representative periods in the fall). Instead, the periods more accurately represent all the data time series combined, including some other parts of the data not seen in this particular plot.


### Extreme Periods Off

GenX has a feature called `ExtremePeriods`, which forces kmeans to include the highest and lowest points in the algorithm. This is done to ensure outliers are used, which is needed in planning energy capacity as the system needs to be able to account for outliers in energy needs. In the above graph, we can see that energy needs peak during the summer, and that the week with the highest load demand is included as a representative week. Let&#39;s try turning extreme periods off, and see what happens. move this up

</code></pre><p>julia time<em>domain</em>reduction<em>settings[&quot;ExtremePeriods&quot;] = 0; YAML.write</em>file(joinpath(case,&quot;settings/genx<em>settings.yml&quot;), genx</em>settings<em>TZ); rm(joinpath(case,&quot;TDR</em>results&quot;), recursive=true) </p><pre><code class="nohighlight hljs">
</code></pre><p>julia include(&quot;example<em>systems/1</em>three_zones/Run.jl&quot;)</p><pre><code class="nohighlight hljs">
</code></pre><p>julia Loads<em>TDR2 = CSV.read(joinpath(case,&quot;TDR</em>Results/Load<em>data.csv&quot;),DataFrame,missingstring=&quot;NA&quot;); Period</em>map2 = CSV.read(joinpath(case,&quot;TDR<em>Results/Period</em>map.csv&quot;),DataFrame,missingstring=&quot;NA&quot;);</p><pre><code class="nohighlight hljs">
</code></pre><p>julia rep<em>periods2 = unique(Period</em>map2[!,&quot;Rep_Period&quot;])</p><p>weeks2 = [] for i in rep<em>periods2     week</em>temp = [repeat([i],168) loads[(168<em>i-167):168</em>i,&quot;Time<em>Index&quot;] loads[(168<em>i-167):168</em>i,&quot;Demand</em>MW<em>z1&quot;]]     weeks2 = [weeks2; week</em>temp] end</p><p>weeks2 = [weeks2 repeat([&quot;Off&quot;],1848)];</p><pre><code class="nohighlight hljs">
</code></pre><p>julia loads<em>plotOff = [repeat([&quot;Total&quot;],8760) loads[!,&quot;Time</em>Index&quot;] loads[!,&quot;Demand<em>MW</em>z1&quot;] repeat([&quot;Off&quot;],8760) ]; loads<em>with</em>TDR[!,&quot;Extreme<em>Periods&quot;] = repeat([&quot;On&quot;],length(loads</em>with<em>TDR[!,1])); loads</em>with<em>TDR2 = [loads</em>plotOff; weeks2]</p><pre><code class="nohighlight hljs">
</code></pre><p>julia loads<em>with</em>TDR2 = DataFrame(loads<em>with</em>TDR2 ,[&quot;Week&quot;,&quot;hour&quot;,&quot;MW&quot;,&quot;Extreme<em>Periods&quot;]) loads</em>with<em>TDR2[!,:hour] = convert.(Int64,loads</em>with<em>TDR2[!,:hour]); loads</em>with<em>TDR2[!,:MW] = convert.(Float64,loads</em>with_TDR2[!,:MW]);</p><pre><code class="nohighlight hljs">
</code></pre><p>julia</p><h1 id="Define-a-new-color-scheme-to-accomodate-more-periods"><a class="docs-heading-anchor" href="#Define-a-new-color-scheme-to-accomodate-more-periods">Define a new color scheme to accomodate more periods</a><a id="Define-a-new-color-scheme-to-accomodate-more-periods-1"></a><a class="docs-heading-anchor-permalink" href="#Define-a-new-color-scheme-to-accomodate-more-periods" title="Permalink"></a></h1><p>myscheme = [&quot;#a6cee3&quot;,&quot;#a6cee3&quot;,&quot;#1f78b4&quot;,&quot;#b2df8a&quot;,&quot;#33a02c&quot;,&quot;#fb9a99&quot;,&quot;#e31a1c&quot;,&quot;#fdbf6f&quot;,&quot;#ff7f00&quot;,     &quot;#cab2d6&quot;,&quot;#6a3d9a&quot;,&quot;#ffff99&quot;,&quot;#b15928&quot;,&quot;#b1ff00&quot;,&quot;#095768&quot;,&quot;#ce7e00&quot;,&quot;#b4a7d6&quot;]; [loads<em>with</em>TDR; loads<em>with</em>TDR2] |&gt; @vlplot(mark={:line}, row=&quot;Extreme_Periods:n&quot;,     x={:hour,title=&quot;Time Step (hours)&quot;,labels=&quot;Week:n&quot;}, y={:MW,title=&quot;Load (MW)&quot;},     color={&quot;Week:n&quot;, scale={scheme=&quot;paired&quot;},sort=&quot;decsending&quot;},      title=&quot;MW Load per hour with TDR Representative Weeks, Extreme Periods Off&quot;,     width=845,height=300)</p><pre><code class="nohighlight hljs">
![svg](./files/t3_ext_periods.svg)

The first plot (with Extreme Periods off) may not have the week with the highest peak highlighted. If the week with the highest demand is highlighted, try re-running the cell with Extreme Periods Off plotting the results.

Turn Extreme Periods back on:
</code></pre><p>julia time<em>domain</em>reduction<em>settings[&quot;ExtremePeriods&quot;] = 1; YAML.write</em>file(joinpath(case,&quot;settings/time<em>domain</em>reduction<em>settings.yml&quot;), time</em>domain<em>reduction</em>settings); rm(joinpath(case,&quot;TDR_results&quot;), recursive=true) </p><pre><code class="nohighlight hljs">
### Reconstruction

Below is a plot of a reconstruction of the data using only the weeks isolated as representative periods. This is what GenX reads when it runs the solver with TDR on.

</code></pre><p>julia recon = [] recon<em>noex = [] for i in range(1,52)     index = Period</em>map[i,&quot;Rep<em>Period&quot;]     recon</em>temp = [repeat([index],168) collect((168<em>i-167):168</em>i) loads[(168<em>index-167):168</em>index,&quot;Demand<em>MW</em>z1&quot;]]     recon = [recon; recon_temp]</p><pre><code class="nohighlight hljs">index2 = Period_map2[i,&quot;Rep_Period&quot;]
recon_noex_temp = [repeat([index2],168) collect((168*i-167):168*i) loads[(168*index2-167):168*index2,&quot;Demand_MW_z1&quot;]]
recon_noex = [recon_noex; recon_noex_temp]</code></pre><p>end</p><p>recon = DataFrame(recon,[&quot;Week&quot;,&quot;hour&quot;, &quot;MW&quot;]) recon[!,:hour] = convert.(Int64,recon[!,:hour]); recon[!,:MW] = convert.(Float64,recon[!,:MW]); recon[!,&quot;Extreme_Periods&quot;] = repeat([&quot;On&quot;],length(recon[!,1]));</p><p>recon<em>noex = [recon</em>noex repeat([&quot;Off&quot;],8736)]; recon<em>noex = DataFrame(recon</em>noex,[&quot;Week&quot;,&quot;hour&quot;, &quot;MW&quot;, &quot;Extreme<em>Periods&quot;]) recon</em>noex[!,:hour] = convert.(Int64,recon<em>noex[!,:hour]); recon</em>noex[!,:MW] = convert.(Float64,recon_noex[!,:MW]);</p><pre><code class="nohighlight hljs">
</code></pre><p>julia plotlyjs() G1 = Plots.plot(recon<em>noex[!,:hour], recon</em>noex[!,:MW], linewidth=1.7,     xticks=0:500:9000,xlabelfontsize=8,     yticks=0:2000:18000,yformatter =:plain,ylims=(0,18000), ylabel=&quot;Demand (MW)&quot;,     legend=false, title=&quot;Reconstruction, Extreme Periods Off&quot;, hover=recon<em>noex[!,:Week],     color=recon</em>noex[!,:Week],size=(845,800),palette=:Paired_12)</p><p>G2 = Plots.plot(recon[!,:hour], recon[!,:MW], linewidth=1.7,     xticks=0:500:9000,xlabel=&quot;Time Step (Hours)&quot;,xlabelfontsize=8,     ylims=(0,18000),yticks=0:2000:18000,yformatter =:plain,ylabel=&quot;Demand (MW)&quot;,     legend=false, title=&quot;Reconstruction, Extreme Periods On&quot;,hover=recon[!,:Week],     color=recon[!,:Week],size=(845,800),palette=:Paired_12)</p><p>Plots.plot(G1,G2,layout=(2,1))</p><pre><code class="nohighlight hljs">
![svg](./files/t3_recon.svg)

Each color represents one of the representative weeks.

The range of 8-11 representative periods was chosen by the developers because it was deemed to be the smallest set that still matches the optimal value of the data well. The next section of this Tutorial goes over how the optimal values of the data change as the number of representative periods changes.

### Objective Values and Representative Periods

Each time `Run.jl` is run, a `results` folder is produced. This folder contains numerous .csv files with output variable from the GenX model. For more information on all outputs, see the documentation [GenX Outputs](@ref).

This section focuses on the __objective value__ of the model. In optimization problems, the objective value is the main value minimized or maximized within the constraints of the model, according to the __objective function__ specified in the problem formulation. In the case of GenX, the objective function is the total annual electricity system cost. A detailed description of the optimization problem is [Objective Function](@ref) in the documentation. 

For the purpose of this tutorial, we focus on the objective value as a way to evaluate how well the representative periods actually &quot;represent&quot; the entire model. To see how well the objective value of representative periods aligns with that of the total period, we can run `example_systems/1_three_zone` with a variety of minimum and maximum total periods.
</code></pre><p>julia time<em>domain</em>reduction_settings</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">Dict{Any, Any} with 15 entries:
&quot;IterativelyAddPeriods&quot; =&gt; 1
&quot;ExtremePeriods&quot;        =&gt; 1
&quot;UseExtremePeriods&quot;     =&gt; 1
&quot;MinPeriods&quot;            =&gt; 8
&quot;MaxPeriods&quot;            =&gt; 11
&quot;DemandWeight&quot;          =&gt; 1
&quot;ClusterFuelPrices&quot;     =&gt; 1
&quot;nReps&quot;                 =&gt; 100
&quot;MultiStageConcatenate&quot; =&gt; 0
&quot;Threshold&quot;             =&gt; 0.05
&quot;TimestepsPerRepPeriod&quot; =&gt; 168
&quot;IterateMethod&quot;         =&gt; &quot;cluster&quot;
&quot;ScalingMethod&quot;         =&gt; &quot;S&quot;
&quot;ClusterMethod&quot;         =&gt; &quot;kmeans&quot;
&quot;WeightTotal&quot;           =&gt; 8760</code></pre><pre><code class="nohighlight hljs">
Each time Run.jl is run, a new results folder appears in the model folder. These folders are not overwritten. So far, we&#39;ve run the model three times, so we should have three results folders in the 1_three_zones folder, but you may have more if you&#39;ve run the model more. To ensure that the following code works, we&#39;ll delete any results folders beyond the original.
</code></pre><p>julia folders = cd(readdir,case)</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">10-element Vector{String}:
&quot;.DS_Store&quot;
&quot;README.md&quot;
&quot;Run.jl&quot;
&quot;policies&quot;
&quot;resources&quot;
&quot;results&quot;
&quot;results_1&quot;
&quot;results_2&quot;
&quot;settings&quot;
&quot;system&quot;</code></pre><pre><code class="nohighlight hljs"></code></pre><p>julia for folder in folders     if length(folder) &gt;= 8 &amp;&amp; folder[1:8] == &quot;results<em>&quot;         rm(&quot;example</em>systems/1<em>three</em>zones/&quot; * folder,recursive=true)      end end</p><p>cd(readdir,case) ## Make sure they were deleted</p><pre><code class="nohighlight hljs"></code></pre><pre><code class="nohighlight hljs">8-element Vector{String}:
&quot;.DS_Store&quot;
&quot;README.md&quot;
&quot;Run.jl&quot;
&quot;policies&quot;
&quot;resources&quot;
&quot;results&quot;
&quot;settings&quot;
&quot;system&quot;</code></pre><pre><code class="nohighlight hljs">To demonstrate how the objective value changes as the number of representative periods does, we&#39;ll run GenX ten times, each with a different number of periods, and plot the objective values.

</code></pre><p>julia</p><h1 id="Change-MinPeriods-and-Max-Periods,-run-Run.jl"><a class="docs-heading-anchor" href="#Change-MinPeriods-and-Max-Periods,-run-Run.jl">Change MinPeriods and Max Periods, run <code>Run.jl</code></a><a id="Change-MinPeriods-and-Max-Periods,-run-Run.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Change-MinPeriods-and-Max-Periods,-run-Run.jl" title="Permalink"></a></h1><h1 id="For-simplicity,-keep-min-and-max-periods-the-same"><a class="docs-heading-anchor" href="#For-simplicity,-keep-min-and-max-periods-the-same">For simplicity, keep min and max periods the same</a><a id="For-simplicity,-keep-min-and-max-periods-the-same-1"></a><a class="docs-heading-anchor-permalink" href="#For-simplicity,-keep-min-and-max-periods-the-same" title="Permalink"></a></h1><p>rep_periods = [4, 8, 12, 24, 36, 48] times = [0.0,0.0,0.0,0.0,0.0,0.0]</p><p>for i in range(1,6)     println(&quot; &quot;)     println(&quot;––––––––––––––––––––––––––&quot;)     println(&quot;Iteration &quot;,i)     println(&quot;Periods = &quot;,rep<em>periods[i])     println(&quot;––––––––––––––––––––––––––&quot;)     time</em>domain<em>reduction</em>settings[&quot;MinPeriods&quot;] = rep<em>periods[i]     time</em>domain<em>reduction</em>settings[&quot;MaxPeriods&quot;] = rep<em>periods[i]     if &quot;TDR</em>Results&quot; in cd(readdir,case)         rm(joinpath(case,&quot;TDR<em>results&quot;, recursive=true))      end     println(&quot; &quot;)     YAML.write</em>file(joinpath(case,&quot;settings/time<em>domain</em>reduction<em>settings.yml&quot;), time</em>domain<em>reduction</em>settings)     time = @elapsed include(&quot;example<em>systmes/1</em>three_zones/Run.jl&quot;)     times[i] = time end</p><pre><code class="nohighlight hljs">
Note that as the number of periods increases, so does the time it takes to run.

Now, let&#39;s check that we have the correct Results folders and process the objecive values to plot. There should be seven results folders, including the original `results`.

</code></pre><p>julia cd(readdir,case)</p><pre><code class="nohighlight hljs">
The objective value is found in the files `costs.csv` and `status.csv`.

</code></pre><p>julia status = CSV.read(joinpath(case,&quot;results/status.csv&quot;),DataFrame,missingstring=&quot;NA&quot;)</p><pre><code class="nohighlight hljs"></code></pre><p>1×3 DataFrame     Row  Status     Solve       Objval          String     Float64     String     ─────────────────────────────────────      1	 OPTIMAL	53.9481	    9762.44</p><pre><code class="nohighlight hljs">
</code></pre><p>julia</p><h1 id="Find-objective-values-from-each-results-folder:"><a class="docs-heading-anchor" href="#Find-objective-values-from-each-results-folder:">Find objective values from each results folder:</a><a id="Find-objective-values-from-each-results-folder:-1"></a><a class="docs-heading-anchor-permalink" href="#Find-objective-values-from-each-results-folder:" title="Permalink"></a></h1><p>OV<em>noTDR = CSV.read(joinpath(case,&quot;Results/status.csv&quot;),DataFrame); OV</em>RP4 = CSV.read(joinpath(case,&quot;Results<em>1/status.csv&quot;),DataFrame); OV</em>RP8 = CSV.read(joinpath(case,&quot;Results<em>2/status.csv&quot;),DataFrame); OV</em>RP12 = CSV.read(joinpath(case,&quot;Results<em>3/status.csv&quot;),DataFrame); OV</em>RP24 = CSV.read(joinpath(case,&quot;Results<em>4/status.csv&quot;),DataFrame); OV</em>RP36 = CSV.read(joinpath(case,&quot;Results<em>5/status.csv&quot;),DataFrame); OV</em>RP48 = CSV.read(joinpath(case,&quot;Results_6/status.csv&quot;),DataFrame);</p><pre><code class="nohighlight hljs">
</code></pre><p>julia</p><h1 id="Isolate-the-objective-values-from-the-data-frame"><a class="docs-heading-anchor" href="#Isolate-the-objective-values-from-the-data-frame">Isolate the objective values from the data frame</a><a id="Isolate-the-objective-values-from-the-data-frame-1"></a><a class="docs-heading-anchor-permalink" href="#Isolate-the-objective-values-from-the-data-frame" title="Permalink"></a></h1><p>obj<em>val</em>tot = [1 OV<em>noTDR[!,3];                 4 OV</em>RP4[!,3];                8 OV<em>RP8[!,3];                12 OV</em>RP12[!,3];                 24 OV<em>RP24[!,3];                 36 OV</em>RP36[!,3];                 48 OV_RP48[!,3]]</p><pre><code class="nohighlight hljs">
</code></pre><p>julia</p><h1 id="Take-the-absolute-difference-between-the-original-objective-value-and-the-new-ones"><a class="docs-heading-anchor" href="#Take-the-absolute-difference-between-the-original-objective-value-and-the-new-ones">Take the absolute difference between the original objective value and the new ones</a><a id="Take-the-absolute-difference-between-the-original-objective-value-and-the-new-ones-1"></a><a class="docs-heading-anchor-permalink" href="#Take-the-absolute-difference-between-the-original-objective-value-and-the-new-ones" title="Permalink"></a></h1><p>obj<em>val</em>plot = [4 abs(OV<em>noTDR[!,3][1]-OV</em>RP4[!,3][1]);                  8 abs(OV<em>noTDR[!,3][1]-OV</em>RP8[!,3][1]);                  12 abs(OV<em>noTDR[!,3][1]-OV</em>RP12[!,3][1]);                 24 abs(OV<em>noTDR[!,3][1]-OV</em>RP24[!,3][1]);                  36 abs(OV<em>noTDR[!,3][1]-OV</em>RP36[!,3][1]);                  48 abs(OV<em>noTDR[!,3][1]-OV</em>RP48[!,3][1])]</p><pre><code class="nohighlight hljs">
</code></pre><p>julia</p><h1 id="Plot-the-differences-as-a-function-of-number-of-representative-periods"><a class="docs-heading-anchor" href="#Plot-the-differences-as-a-function-of-number-of-representative-periods">Plot the differences as a function of number of representative periods</a><a id="Plot-the-differences-as-a-function-of-number-of-representative-periods-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-differences-as-a-function-of-number-of-representative-periods" title="Permalink"></a></h1><p>plotlyjs() Plots.scatter(obj<em>val</em>plot[:,1],obj<em>val</em>plot[:,2],hover=obj<em>val</em>plot[:,2],legend=false,xticks=obj<em>val</em>plot[:,1],                 ylabel=&quot;|ObjValue[1] - ObjValue[x]|&quot;,xlabel=&quot;Rep Periods&quot;,title=&quot;Difference in Objective Values&quot;) scatter!(twinx(),obj<em>val</em>plot[:,1],times,color=:red,markeralpha=.5,label=:&quot;Time&quot;,legend=:topleft,     yaxis=(label=&quot;Time&quot;)) ygrid!(:on, :dashdot, 0.1)</p><pre><code class="nohighlight hljs">
![svg](./files/t3_obj_val.svg)

Here, we can see that while having very few representative periods produces an objective value that differs greatly from the orignal, once we reach around 12 representative periods the difference begins to taper out. Therefore, the original choice of 11 maximum periods in `1_three_zones` decreases the run time of GenX significantly while while maintaining an objective value close to the original. 


It&#39;s important to note, however, that  the difference does not always taper out, and for some systems you&#39;ll find that the error in objective value continues to decrease as the number of representative periods increases. There also is no way to know apriori what number of periods works.

Finally, let&#39;s set TDR to have 8 and 11 min/max periods again, and delete the TDR Results folder.

</code></pre><p>julia time<em>domain</em>reduction<em>settings[&quot;MinPeriods&quot;] = 8; time</em>domain<em>reduction</em>settings[&quot;MaxPeriods&quot;] = 11;</p><pre><code class="nohighlight hljs">
</code></pre><p>julia time<em>domain</em>reduction_settings</p><pre><code class="nohighlight hljs">
</code></pre><p>julia rm(joinpath(case,&quot;TDR_results&quot;, recursive=true))</p><pre><code class="nohighlight hljs">
</code></pre><p>julia rm(joinpath(case,&quot;TDR<em>results&quot;), recursive=true)  YAML.write</em>file(joinpath(case,&quot;settings/time<em>domain</em>reduction<em>settings.yml&quot;), time</em>domain<em>reduction</em>settings) folders = cd(readdir,case) for folder in folders     if length(folder) &gt;= 7 &amp;&amp; folder[1:7] == &quot;results&quot;         rm(&quot;example<em>systems/1</em>three_zones/&quot; * folder,recursive=true)      end end```</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Tutorial_2_network_visualization/">« Tutorial 2: Network Visualization</a><a class="docs-footer-nextpage" href="../Tutorial_4_model_generation/">Tutorial 4: Model Generation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 3 May 2024 18:40">Friday 3 May 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
